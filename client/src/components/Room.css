/* ============================================================
   ROOM — Mobile-First Design
   Strategy: Design for 390px first. Desktop gets sidebar.
   ============================================================ */

/* ── Tokens ─────────────────────────────────────────────────── */
:root {
  --pink:      #ff6eb4;
  --purple:    #a855f7;
  --cyan:      #22d3ee;
  --bg:        #060410;
  --bg-card:   rgba(12, 8, 28, 0.92);
  --border:    rgba(255,255,255,0.08);
  --text:      #ffffff;
  --text-2:    rgba(255,255,255,0.65);
  --text-3:    rgba(255,255,255,0.32);
  --grad:      linear-gradient(135deg, var(--pink), var(--purple));
  --grad-3:    linear-gradient(135deg, var(--pink), var(--purple), #3b82f6);
  --spring:    cubic-bezier(0.34, 1.56, 0.64, 1);
  --bar-h:     72px;
}

/* ── Shell ───────────────────────────────────────────────────── */
.room {
  display:        flex;
  flex-direction: column;
  min-height:     100dvh;          /* dvh = accounts for mobile browser chrome */
  background:     var(--bg);
  color:          var(--text);
  position:       relative;
  overflow-x:     hidden;          /* NEVER horizontal scroll */
}

/* ── Ambient orbs ─────────────────────────────────────────────── */
.room-orb {
  position:       fixed;
  border-radius:  50%;
  pointer-events: none;
  z-index:        0;
}
.room-orb--a {
  top:-20%; right:-10%;
  width:500px; height:500px;
  background:radial-gradient(ellipse, rgba(168,85,247,0.14) 0%, transparent 65%);
  animation:orb-drift 16s ease-in-out infinite alternate;
}
.room-orb--b {
  bottom:-5%; left:5%;
  width:400px; height:300px;
  background:radial-gradient(ellipse, rgba(34,211,238,0.07) 0%, transparent 60%);
  animation:orb-drift 12s ease-in-out infinite alternate-reverse;
}
.room-orb--celebrate {
  top:50%; left:50%;
  transform:translate(-50%,-50%);
  width:800px; height:800px;
  background:radial-gradient(ellipse, rgba(168,85,247,0.25) 0%, rgba(255,110,180,0.12) 40%, transparent 65%);
  animation:orb-celebrate 3s ease-out forwards;
}
@keyframes orb-drift    { 0% { transform:translate(0,0) scale(1); } 100% { transform:translate(-30px,30px) scale(1.07); } }
@keyframes orb-celebrate{ 0% { opacity:0; transform:translate(-50%,-50%) scale(0.3); } 25% { opacity:1; transform:translate(-50%,-50%) scale(1); } 100% { opacity:0; transform:translate(-50%,-50%) scale(1.5); } }

/* Blurred art bg */
.room-art-bg {
  position:fixed; inset:0; z-index:0;
  background-size:cover; background-position:center;
  filter:blur(80px) brightness(0.14) saturate(1.8);
  pointer-events:none;
  animation:art-bg-fade 1s ease forwards;
}
@keyframes art-bg-fade { from { opacity:0; } to { opacity:1; } }

/* Celebration shell flash */
.room--celebrating { animation:flash 3s ease-out; }
@keyframes flash { 0%,100% { filter:brightness(1); } 15% { filter:brightness(1.1); } }

/* ── Floating reactions ──────────────────────────────────────── */
.reactions-stage {
  position:fixed; bottom:calc(var(--bar-h) + 16px); right:16px;
  z-index:200; pointer-events:none;
  display:flex; flex-direction:column-reverse; gap:8px; align-items:flex-end;
}
.r-float { font-size:2rem; display:block; animation:rfloat 2.8s ease-out forwards; }
.r-float--partner { animation-name:rfloat-p; }
@keyframes rfloat  { 0%{opacity:0;transform:translateY(0) scale(0.3)} 15%{opacity:1;transform:translateY(-8px) scale(1.2)} 80%{opacity:1;transform:translateY(-80px)} 100%{opacity:0;transform:translateY(-110px) scale(0.85)} }
@keyframes rfloat-p{ 0%{opacity:0;transform:translateX(-12px) scale(0.3)} 15%{opacity:1;transform:scale(1.2)} 80%{opacity:1;transform:translateY(-60px)} 100%{opacity:0;transform:translateY(-90px) scale(0.85)} }

/* ── Toast ───────────────────────────────────────────────────── */
.toast {
  position:fixed; top:calc(56px + 10px); left:50%;
  transform:translateX(-50%);
  z-index:300;
  display:inline-flex; align-items:center; gap:8px;
  padding:9px 20px; border-radius:100px;
  backdrop-filter:blur(20px); -webkit-backdrop-filter:blur(20px);
  font-size:0.82rem; font-weight:600; white-space:nowrap;
  max-width:calc(100vw - 32px);
  overflow:hidden; text-overflow:ellipsis;
  animation:toast-pop 0.3s var(--spring) forwards;
  box-shadow:0 8px 28px rgba(0,0,0,0.5);
}
@keyframes toast-pop { from{opacity:0;transform:translateX(-50%) translateY(-8px) scale(0.95)} to{opacity:1;transform:translateX(-50%) translateY(0) scale(1)} }
.toast-dot { width:6px; height:6px; border-radius:50%; background:currentColor; animation:pdot 1s infinite; flex-shrink:0; }
@keyframes pdot { 0%,100%{opacity:1} 50%{opacity:0.4} }

.toast--info,
.toast--play  { background:rgba(168,85,247,0.18); border:1px solid rgba(168,85,247,0.38); color:#d4a8ff; }
.toast--pause { background:rgba(255,255,255,0.07); border:1px solid rgba(255,255,255,0.12); color:var(--text-2); }
.toast--sync  { background:rgba(255,110,180,0.18); border:1px solid rgba(255,110,180,0.42); color:#ffb3d9; }
.toast--join  { background:rgba(34,197,94,0.1);   border:1px solid rgba(34,197,94,0.3);   color:#86efac; }
.toast--leave { background:rgba(255,255,255,0.05); border:1px solid rgba(255,255,255,0.08); color:var(--text-3); }

/* ── Celebration ─────────────────────────────────────────────── */
.celebrate {
  position:fixed; inset:0; z-index:190;
  display:flex; align-items:center; justify-content:center;
  pointer-events:none;
}
.celebrate-ring {
  position:absolute; border-radius:50%;
  border:2px solid rgba(168,85,247,0.55);
  animation:cring 3s ease-out forwards;
}
.celebrate-ring--1 { width:80px;  height:80px;  animation-delay:0s;   }
.celebrate-ring--2 { width:180px; height:180px; animation-delay:0.15s;}
.celebrate-ring--3 { width:300px; height:300px; animation-delay:0.3s; }
@keyframes cring { 0%{transform:scale(0.8);opacity:0.9} 100%{transform:scale(3);opacity:0} }
.celebrate-text {
  position:relative; font-size:2rem; font-weight:800; letter-spacing:-0.03em;
  background:var(--grad); -webkit-background-clip:text; background-clip:text; -webkit-text-fill-color:transparent;
  animation:ctxt 3s ease-out forwards;
}
@keyframes ctxt { 0%{opacity:0;transform:translateY(12px) scale(0.9)} 20%{opacity:1;transform:scale(1.05)} 75%{opacity:1;transform:translateY(-4px)} 100%{opacity:0;transform:translateY(-20px) scale(0.95)} }

/* ════════════════════════════════════════════════════════════════
   TOP BAR — thin, 56px, always readable
════════════════════════════════════════════════════════════════ */
.topbar {
  position:sticky; top:0; z-index:100;
  height:56px;
  display:flex; align-items:center; justify-content:space-between;
  padding:0 16px;
  background:rgba(6,4,16,0.92);
  backdrop-filter:blur(20px); -webkit-backdrop-filter:blur(20px);
  border-bottom:1px solid var(--border);
  flex-shrink:0;
}

.topbar-brand {
  display:flex; align-items:center; gap:8px; text-decoration:none;
}
.topbar-logo {
  width:26px; height:26px; object-fit:contain;
  filter:drop-shadow(0 0 6px rgba(168,85,247,0.6));
}
.topbar-name {
  font-size:1rem; font-weight:800; letter-spacing:-0.02em;
  background:linear-gradient(to right, #fff 20%, var(--purple));
  -webkit-background-clip:text; background-clip:text; -webkit-text-fill-color:transparent;
}
.topbar-name span { -webkit-text-fill-color: transparent; }

.topbar-right { display:flex; align-items:center; gap:10px; }

/* Sync chip */
.sync-chip {
  font-size:0.7rem; font-weight:700; letter-spacing:0.02em;
  padding:4px 10px; border-radius:100px;
}
.sync--perfect { background:rgba(168,85,247,0.18); border:1px solid rgba(168,85,247,0.4); color:#d4a8ff; }
.sync--good    { background:rgba(34,197,94,0.12);  border:1px solid rgba(34,197,94,0.35);  color:#86efac; }
.sync--ok      { background:rgba(250,204,21,0.1);  border:1px solid rgba(250,204,21,0.3);  color:#fde68a; }
.sync--slow    { background:rgba(239,68,68,0.1);   border:1px solid rgba(239,68,68,0.3);   color:#fca5a5; }

/* Connection dot */
.conn-dot {
  width:8px; height:8px; border-radius:50%;
  background:var(--text-3);
  transition:background 0.4s, box-shadow 0.4s;
}
.conn-dot--live { background:rgba(34,197,94,0.85); box-shadow:0 0 6px rgba(34,197,94,0.5); animation:pdot 2.5s infinite; }

/* ════════════════════════════════════════════════════════════════
   MAIN SCROLL — single vertical column
════════════════════════════════════════════════════════════════ */
.room-scroll {
  flex:1;
  display:flex; flex-direction:column; align-items:stretch;
  gap:14px;
  padding:20px 16px calc(var(--bar-h) + 20px);
  position:relative; z-index:1;
  overflow-y:auto; overflow-x:hidden;
  width:100%;
  max-width:600px;
  margin:0 auto;
  box-sizing:border-box;
}

/* ════════════════════════════════════════════════════════════════
   ROOM CODE CARD — prominent, impossible to miss
════════════════════════════════════════════════════════════════ */
.room-code-card {
  background:   rgba(11, 7, 26, 0.88);
  border:       1px solid rgba(168,85,247,0.18);
  border-radius:20px;
  padding:      28px 20px;
  text-align:   center;
  backdrop-filter:blur(32px); -webkit-backdrop-filter:blur(32px);
  box-shadow:   0 12px 40px rgba(0,0,0,0.4), 0 0 0 1px rgba(255,255,255,0.03) inset;
  animation:    card-in 0.4s var(--spring) forwards;
}
@keyframes card-in { from{opacity:0;transform:translateY(16px) scale(0.97)} to{opacity:1;transform:none} }

.room-code-label {
  font-size:0.72rem; font-weight:700; letter-spacing:0.1em; text-transform:uppercase;
  color:var(--text-3); margin-bottom:14px;
}

.room-code-big {
  font-family:   ui-monospace, 'Cascadia Code', monospace;
  font-size:     clamp(2rem, 12vw, 3.5rem);
  font-weight:   900;
  letter-spacing:0.22em;
  color:         var(--text);
  text-shadow:   0 0 32px rgba(168,85,247,0.5);
  padding:       12px 0;
  background:    var(--grad-3);
  -webkit-background-clip:text; background-clip:text; -webkit-text-fill-color:transparent;
}

.room-code-hint {
  font-size:0.78rem; color:var(--text-3); margin-bottom:20px; line-height:1.5;
}

.room-code-actions {
  display:flex; gap:8px; justify-content:center; flex-wrap:wrap;
}

.code-btn {
  display:       inline-flex;
  align-items:   center;
  gap:           7px;
  padding:       11px 18px;
  border-radius: 12px;
  font-size:     0.84rem;
  font-weight:   700;
  cursor:        pointer;
  transition:    transform 0.15s var(--spring), opacity 0.15s;
}
.code-btn:active { transform:scale(0.94); }

.code-btn--primary {
  background: var(--grad);
  border:     none;
  color:      #fff;
  box-shadow: 0 4px 16px rgba(168,85,247,0.4);
}
.code-btn--secondary {
  background: rgba(255,255,255,0.06);
  border:     1px solid rgba(255,255,255,0.12);
  color:      var(--text-2);
}
.code-btn--share {
  background: rgba(34,197,94,0.1);
  border:     1px solid rgba(34,197,94,0.25);
  color:      #86efac;
}

/* ════════════════════════════════════════════════════════════════
   PARTNER BAR
════════════════════════════════════════════════════════════════ */
.partner-bar {
  display:flex; align-items:center; justify-content:center;
  gap:0; padding:16px 0 4px;
}

.partner-bar__me,
.partner-bar__them {
  display:flex; flex-direction:column; align-items:center; gap:6px;
}

.p-avatar {
  width:56px; height:56px; border-radius:50%;
  display:flex; align-items:center; justify-content:center;
  font-size:1.1rem; font-weight:700; color:#fff;
  border:2px solid rgba(255,255,255,0.1);
  position:relative; overflow:hidden;
  transition:box-shadow 0.4s, border-color 0.4s;
}
.p-avatar img { width:100%; height:100%; object-fit:cover; border-radius:50%; }

.p-avatar--me      { background:var(--grad); box-shadow:0 0 0 2px rgba(255,110,180,0.22); }
.p-avatar--partner { background:linear-gradient(135deg,var(--purple),var(--cyan)); }
.p-avatar--waiting { background:rgba(255,255,255,0.05); color:var(--text-3); }
.p-avatar__ghost   { font-size:1.2rem; color:var(--text-3); }

/* Heartbeat pulse when both playing */
.p-avatar--playing { animation:hb-avatar 2.2s ease-in-out infinite; }
@keyframes hb-avatar {
  0%,100% { box-shadow:0 0 0 2px rgba(255,110,180,0.25), 0 0 12px rgba(255,110,180,0.15); }
  50%     { box-shadow:0 0 0 5px rgba(255,110,180,0.1),  0 0 24px rgba(255,110,180,0.35); }
}

.p-avatar__beat {
  position:absolute; inset:-6px; border-radius:50%;
  border:2px solid rgba(255,110,180,0.7);
  animation:beat-ring 2s ease-in-out infinite;
}
@keyframes beat-ring { 0%,100%{opacity:0.8;transform:scale(1)} 50%{opacity:0;transform:scale(1.25)} }

.p-avatar__status-dot {
  position:absolute; bottom:1px; right:1px;
  width:12px; height:12px; border-radius:50%;
  background:rgba(34,197,94,0.9); border:2px solid var(--bg);
  box-shadow:0 0 6px rgba(34,197,94,0.6);
  animation:pdot 2.5s infinite;
}
.p-avatar__status-dot--playing {
  background:var(--pink); box-shadow:0 0 8px rgba(255,110,180,0.7);
}

.p-name { font-size:0.72rem; font-weight:500; color:var(--text-3); max-width:80px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }

/* Connector */
.p-connector {
  display:flex; align-items:center;
  width:clamp(60px, 18vw, 100px); flex-shrink:0;
  padding:0 4px;
}
.p-connector__line { flex:1; height:1.5px; background:rgba(255,255,255,0.1); border-radius:99px; transition:background 0.4s; }
.p-connector--on .p-connector__line { background:linear-gradient(to right, rgba(255,110,180,0.5), rgba(168,85,247,0.5)); }
.p-connector__heart {
  width:28px; height:28px; border-radius:50%;
  display:flex; align-items:center; justify-content:center;
  font-size:0.9rem; flex-shrink:0;
  background:rgba(255,255,255,0.04);
  border:1px solid rgba(255,255,255,0.1);
  color:var(--text-3);
  transition:color 0.4s, background 0.4s, border-color 0.4s, box-shadow 0.4s;
}
.p-connector--on .p-connector__heart   { color:var(--pink); border-color:rgba(255,110,180,0.3); }
.p-connector--sync .p-connector__heart { color:var(--pink); background:rgba(255,110,180,0.1); border-color:rgba(255,110,180,0.4); box-shadow:0 0 12px rgba(255,110,180,0.5); animation:heart-pulse 1.4s ease-in-out infinite; }
@keyframes heart-pulse { 0%,100%{transform:scale(1)} 30%{transform:scale(1.35)} 60%{transform:scale(1.15)} }

/* Partner status pill */
.partner-status-pill {
  display:flex; align-items:center; justify-content:center; gap:7px;
  font-size:0.76rem; font-weight:600; color:var(--text-3);
  padding:6px 14px;
  background:rgba(255,255,255,0.04); border:1px solid var(--border);
  border-radius:100px; align-self:center;
  transition:all 0.4s;
}
.psp-dot {
  width:6px; height:6px; border-radius:50%; background:var(--text-3);
  transition:background 0.4s, box-shadow 0.4s;
}
.dot--on      .psp-dot { background:rgba(34,197,94,0.9);  box-shadow:0 0 6px rgba(34,197,94,0.6); animation:pdot 2.5s infinite; }
.dot--playing .psp-dot { background:var(--pink);           box-shadow:0 0 8px rgba(255,110,180,0.7); animation:pdot 1.5s infinite; }
.dot--off     .psp-dot { background:var(--text-3); }

.dot--playing { color:var(--text-2); background:rgba(255,110,180,0.08); border-color:rgba(255,110,180,0.2); }
.dot--on      { color:var(--text-2); background:rgba(34,197,94,0.06); border-color:rgba(34,197,94,0.2); }

/* ════════════════════════════════════════════════════════════════
   PLAYER CARD
════════════════════════════════════════════════════════════════ */
.player-card {
  background:      rgba(11, 7, 26, 0.88);
  backdrop-filter: blur(48px);
  -webkit-backdrop-filter:blur(48px);
  border:          1px solid rgba(255,255,255,0.09);
  border-radius:   22px;
  padding:         20px;
  display:         flex;
  flex-direction:  column;
  gap:             18px;
  box-shadow:      0 24px 56px rgba(0,0,0,0.55), 0 0 0 1px rgba(255,255,255,0.03) inset;
  position:        relative; overflow:hidden;
  transition:      box-shadow 0.5s, border-color 0.5s;
}
.player-card::before {
  content:''; position:absolute; top:0; left:0; right:0; height:1px;
  background:linear-gradient(to right, transparent 5%, rgba(255,255,255,0.1) 50%, transparent 95%);
  pointer-events:none;
}
.player-card--playing { border-color:rgba(255,110,180,0.15); box-shadow:0 24px 56px rgba(0,0,0,0.55), 0 0 48px rgba(255,110,180,0.08); }
.player-card--synced  { animation:card-synced 3s ease-out; }
@keyframes card-synced { 0%{border-color:rgba(255,255,255,0.09)} 15%{border-color:rgba(168,85,247,0.5);box-shadow:0 24px 56px rgba(0,0,0,0.55),0 0 72px rgba(168,85,247,0.28)} 100%{border-color:rgba(255,110,180,0.15)} }

/* ── Album art — full width ───────────────────────────────────── */
.art-container {
  width:          100%;
  aspect-ratio:   1 / 1;
  border-radius:  14px;
  overflow:       hidden;
  position:       relative;
  background:     linear-gradient(135deg, #160730, #08132e);
  box-shadow:     0 12px 40px rgba(0,0,0,0.6);
  transition:     box-shadow 0.5s;
  flex-shrink:    0;
}
.art-container--playing { box-shadow:0 12px 36px rgba(168,85,247,0.28), 0 8px 28px rgba(0,0,0,0.55); }
.art-img { width:100%; height:100%; object-fit:cover; display:block; transition:transform 1s ease; }
.art-container--playing .art-img { transform:scale(1.03); }
.art-placeholder { width:100%; height:100%; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:14px; }
.art-placeholder__hint { font-size:0.75rem; color:var(--text-3); text-align:center; max-width:200px; line-height:1.5; }
.art-glow {
  position:absolute; inset:0;
  background:radial-gradient(ellipse at 30% 20%, rgba(255,110,180,0.18) 0%, transparent 55%);
  animation:art-glow-pulse 3s ease-in-out infinite alternate;
}
@keyframes art-glow-pulse { 0%{opacity:0.6} 100%{opacity:1} }

/* ── Track info ──────────────────────────────────────────────── */
.track-info { display:flex; flex-direction:column; gap:8px; }

.track-badges { display:flex; gap:6px; flex-wrap:wrap; align-items:center; }
.track-badge {
  display:inline-flex; align-items:center; gap:4px;
  padding:3px 10px; border-radius:100px;
  font-size:0.68rem; font-weight:700; letter-spacing:0.02em;
  background:rgba(255,255,255,0.05); border:1px solid var(--border); color:var(--text-3);
  transition:all 0.4s;
}
.track-badge--playing { background:rgba(255,110,180,0.12); border-color:rgba(255,110,180,0.3); color:#ffb3d9; }
.track-badge--time    { background:rgba(168,85,247,0.1);   border-color:rgba(168,85,247,0.28); color:#c4b5fd; }

.track-name {
  font-size:        clamp(1.2rem, 5.5vw, 1.7rem);
  font-weight:      800;
  letter-spacing:   -0.02em;
  line-height:      1.2;
  color:            var(--text);
  overflow:         hidden;
  display:          -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-line-clamp: 2;
  line-clamp:       2;
}
.track-artist { font-size:0.85rem; color:var(--text-3); }

/* Waveform */
.waveform { display:flex; align-items:center; gap:2px; height:28px; overflow:hidden; }
.w-bar { width:3px; min-height:3px; border-radius:99px; background:rgba(255,255,255,0.1); transition:height 0.4s ease, background 0.4s; flex-shrink:0; }
.w-bar--active { background:var(--grad); animation:wdance 0.8s ease-in-out infinite alternate; }
@keyframes wdance { 0%{transform:scaleY(0.35);opacity:0.6} 100%{transform:scaleY(1);opacity:1} }

/* ── Progress bar ─────────────────────────────────────────────── */
.progress-wrap { display:flex; flex-direction:column; gap:6px; }
.progress-track {
  width:100%; height:5px; border-radius:99px;
  background:rgba(255,255,255,0.09); position:relative; overflow:visible;
  touch-action:none;
}
.progress-fill {
  height:100%; border-radius:99px;
  background:var(--grad-3);
  position:relative; box-shadow:0 0 8px rgba(168,85,247,0.35);
  transition:width 0.5s linear;
}
.progress-thumb {
  position:absolute; right:-7px; top:50%; transform:translateY(-50%);
  width:16px; height:16px; border-radius:50%;
  background:#fff; box-shadow:0 0 14px rgba(168,85,247,0.8);
  opacity:0; transition:opacity 0.15s;
}
.progress-track:hover .progress-thumb,
.progress-track:focus .progress-thumb { opacity:1; }
.progress-times {
  display:flex; justify-content:space-between;
  font-size:0.68rem; color:var(--text-3);
  font-family:ui-monospace,monospace;
  font-variant-numeric:tabular-nums;
}

/* ── Controls — large thumb-friendly ─────────────────────────── */
.controls { display:flex; align-items:center; justify-content:center; gap:clamp(16px, 6vw, 28px); }

.ctrl {
  border:none; background:none; color:var(--text-2);
  display:flex; align-items:center; justify-content:center;
  cursor:pointer; border-radius:50%;
  -webkit-tap-highlight-color:transparent;
}
.ctrl--sm {
  width:52px; height:52px;
  background:rgba(255,255,255,0.06);
  border:1px solid rgba(255,255,255,0.1);
  color:var(--text-2);
  transition:background 0.15s, transform 0.12s var(--spring);
}
.ctrl--sm:hover:not(:disabled)  { background:rgba(255,255,255,0.12); }
.ctrl--sm:active:not(:disabled) { transform:scale(0.9); }
.ctrl--sm:disabled { opacity:0.3; cursor:default; }

.ctrl--play {
  width:80px; height:80px; border-radius:50%;
  box-shadow:0 0 24px rgba(168,85,247,0.38), 0 8px 24px rgba(0,0,0,0.5);
  transition:transform 0.15s var(--spring), box-shadow 0.2s;
  position:relative;
}
.ctrl--play { background:var(--grad-3); color:#fff; }
.ctrl--pause { background:var(--grad); color:#fff; box-shadow:0 0 24px rgba(255,110,180,0.38), 0 8px 24px rgba(0,0,0,0.5); }
.ctrl--celebrating { animation:play-pop 3s ease-out; }
@keyframes play-pop { 0%{transform:scale(1)} 12%{transform:scale(1.25)} 28%{transform:scale(0.95)} 40%{transform:scale(1.1)} 100%{transform:scale(1)} }
.ctrl--play:hover:not(:disabled)  { transform:scale(1.07); }
.ctrl--play:active:not(:disabled) { transform:scale(0.94); }
.ctrl--play:disabled { opacity:0.4; cursor:default; }

.ctrl--play-ring {
  position:absolute; inset:-12px; border-radius:50%;
  border:2px solid rgba(168,85,247,0.65);
  animation:cring 2.5s ease-out forwards;
}

/* ── Volume — full-width, clear ──────────────────────────────── */
.volume-row {
  display:flex; align-items:center; gap:10px;
  padding:0 4px;
}
.volume-row svg { color:var(--text-3); flex-shrink:0; }
.volume-slider {
  flex:1; height:4px;
  accent-color:var(--purple);
  cursor:pointer;
  border-radius:99px;
}

/* ── Action row ─────────────────────────────────────────────── */
.action-row {
  display:flex; align-items:center; gap:8px; flex-wrap:wrap;
  padding-top:12px; border-top:1px solid rgba(255,255,255,0.06);
}
.action-btn {
  display:inline-flex; align-items:center; gap:6px;
  padding:8px 14px; border-radius:100px;
  background:rgba(255,255,255,0.05); border:1px solid var(--border);
  color:var(--text-3); font-size:0.78rem; font-weight:700;
  cursor:pointer;
  transition:background 0.15s, color 0.15s, border-color 0.15s, transform 0.12s var(--spring);
  -webkit-tap-highlight-color:transparent;
}
.action-btn:hover  { background:rgba(168,85,247,0.1); color:var(--text-2); border-color:rgba(168,85,247,0.3); }
.action-btn:active { transform:scale(0.94); }
.action-btn--on    { background:rgba(168,85,247,0.14); color:#c4b5fd; border-color:rgba(168,85,247,0.38); }

.emoji-row { display:flex; align-items:center; gap:4px; margin-left:auto; }
.emoji-btn {
  width:34px; height:34px; border-radius:50%;
  background:rgba(255,255,255,0.04); border:1px solid rgba(255,255,255,0.08);
  font-size:1rem; display:flex; align-items:center; justify-content:center;
  cursor:pointer;
  transition:transform 0.12s var(--spring), background 0.15s;
  -webkit-tap-highlight-color:transparent;
}
.emoji-btn:hover  { transform:scale(1.3); background:rgba(255,255,255,0.1); }
.emoji-btn:active { transform:scale(0.88); }

/* ── Compact room code (after partner joins) ─────────────────── */
.room-code-compact {
  display:flex; align-items:center; gap:8px;
  padding:12px 16px; border-radius:12px;
  background:rgba(255,255,255,0.03); border:1px solid var(--border);
}
.rcc-label { font-size:0.65rem; font-weight:700; color:var(--text-3); text-transform:uppercase; letter-spacing:0.08em; }
.rcc-code {
  flex:1;
  font-family:ui-monospace,monospace; font-size:0.9rem; font-weight:700;
  letter-spacing:0.15em; color:var(--text);
  background:rgba(168,85,247,0.09); border:1px solid rgba(168,85,247,0.2);
  border-radius:7px; padding:3px 9px;
}
.rcc-btn {
  width:30px; height:30px; border-radius:8px;
  background:rgba(255,255,255,0.05); border:1px solid var(--border);
  color:var(--text-3); display:flex; align-items:center; justify-content:center;
  cursor:pointer; font-size:0.75rem;
  transition:background 0.15s, color 0.15s;
}
.rcc-btn:hover { background:rgba(255,255,255,0.1); color:var(--text); }

/* ── Leave button ─────────────────────────────────────────────── */
.leave-btn {
  padding:12px; border-radius:12px;
  background:rgba(255,255,255,0.03); border:1px solid rgba(255,255,255,0.07);
  color:var(--text-3); font-size:0.84rem; font-weight:600;
  cursor:pointer; width:100%;
  transition:background 0.15s, color 0.15s, border-color 0.15s;
}
.leave-btn:hover { background:rgba(248,113,113,0.08); border-color:rgba(248,113,113,0.25); color:#fca5a5; }

/* ════════════════════════════════════════════════════════════════
   MINI BAR — sticky bottom player
════════════════════════════════════════════════════════════════ */
.mini-bar {
  position:        fixed;
  bottom:          0; left:0; right:0;
  height:          var(--bar-h);
  z-index:         100;
  display:         flex;
  align-items:     center;
  justify-content: space-between;
  padding:         0 16px;
  gap:             12px;
  background:      rgba(5, 3, 14, 0.98);
  backdrop-filter: blur(40px); -webkit-backdrop-filter:blur(40px);
  border-top:      1px solid rgba(255,255,255,0.07);
  box-shadow:      0 -8px 32px rgba(0,0,0,0.35);
  /* Safe area for iOS home indicator */
  padding-bottom:  env(safe-area-inset-bottom, 0px);
}

.mini-bar__track  { display:flex; align-items:center; gap:10px; min-width:0; flex:1; }
.mini-bar__art    { width:40px; height:40px; border-radius:7px; object-fit:cover; flex-shrink:0; box-shadow:0 0 12px rgba(168,85,247,0.35); }
.mini-bar__art-ph { width:40px; height:40px; border-radius:7px; background:linear-gradient(135deg,#160730,#08132e); display:flex; align-items:center; justify-content:center; color:var(--text-3); flex-shrink:0; }
.mini-bar__info   { min-width:0; }
.mini-bar__name   { font-size:0.82rem; font-weight:600; color:var(--text); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; max-width:120px; }
.mini-bar__artist { font-size:0.68rem; color:var(--text-3); }

.mini-bar__controls { display:flex; align-items:center; gap:10px; flex-shrink:0; }
.mini-ctrl {
  width:36px; height:36px; border-radius:50%;
  background:rgba(255,255,255,0.05); border:1px solid rgba(255,255,255,0.08);
  color:var(--text-2); display:flex; align-items:center; justify-content:center;
  cursor:pointer; transition:background 0.15s; -webkit-tap-highlight-color:transparent;
}
.mini-ctrl:disabled { opacity:0.3; cursor:default; }
.mini-ctrl--play  { width:44px; height:44px; background:var(--grad); border:none; color:#fff; box-shadow:0 0 16px rgba(168,85,247,0.45); }
.mini-ctrl--pause { background:var(--grad); }
.mini-ctrl:active:not(:disabled) { transform:scale(0.93); }

.mini-bar__right { display:flex; align-items:center; gap:6px; flex-shrink:0; }
.mini-icon-btn {
  width:32px; height:32px; border-radius:8px;
  background:rgba(255,255,255,0.04); border:1px solid var(--border);
  color:var(--text-3); display:flex; align-items:center; justify-content:center;
  cursor:pointer; transition:background 0.15s, color 0.15s;
  -webkit-tap-highlight-color:transparent;
}
.mini-icon-btn:hover   { background:rgba(255,255,255,0.09); color:var(--text-2); }
.mini-icon-btn--on     { background:rgba(168,85,247,0.12); color:#c4b5fd; border-color:rgba(168,85,247,0.3); }

/* ════════════════════════════════════════════════════════════════
   SESSION SUMMARY
════════════════════════════════════════════════════════════════ */
.summary-overlay {
  position:fixed; inset:0; z-index:400;
  display:flex; align-items:flex-end; justify-content:center;
  background:rgba(6,4,16,0.8); backdrop-filter:blur(20px); -webkit-backdrop-filter:blur(20px);
  animation:fade-up 0.25s ease forwards;
  padding:0;
}
@keyframes fade-up { from{opacity:0} to{opacity:1} }

.summary-card {
  width:100%; max-width:480px;
  background:rgba(12,8,28,0.98); backdrop-filter:blur(48px); -webkit-backdrop-filter:blur(48px);
  border:1px solid rgba(255,255,255,0.1); border-radius:24px 24px 0 0;
  padding:28px 24px calc(28px + env(safe-area-inset-bottom,0px));
  text-align:center;
  box-shadow:0 -24px 64px rgba(0,0,0,0.8), 0 0 48px rgba(168,85,247,0.12);
  animation:sheet-up 0.35s var(--spring) forwards;
}
@keyframes sheet-up { from{transform:translateY(60%)} to{transform:translateY(0)} }

.summary-icon  { font-size:2.4rem; margin-bottom:10px; }
.summary-title { font-size:1.5rem; font-weight:800; letter-spacing:-0.03em; margin:0 0 6px; }
.summary-sub   { font-size:0.8rem; color:var(--text-3); margin:0 0 20px; }

.summary-stats {
  display:grid; grid-template-columns:repeat(3,1fr); gap:12px;
  padding:16px 0; margin-bottom:16px;
  border-top:1px solid rgba(255,255,255,0.06); border-bottom:1px solid rgba(255,255,255,0.06);
}
.summary-stat  { display:flex; flex-direction:column; gap:3px; align-items:center; }
.ss-val {
  font-size:1.8rem; font-weight:800; line-height:1;
  background:var(--grad-3); -webkit-background-clip:text; background-clip:text; -webkit-text-fill-color:transparent;
  font-family:ui-monospace,monospace;
}
.ss-label { font-size:0.62rem; font-weight:700; color:var(--text-3); letter-spacing:0.08em; text-transform:uppercase; }

.summary-msg { font-size:0.86rem; color:var(--text-2); line-height:1.65; font-style:italic; margin:0 0 20px; }

.summary-leave-btn {
  display:block; width:100%; padding:14px;
  border-radius:14px; border:none; cursor:pointer; font-size:0.9rem; font-weight:700;
  background:var(--grad); color:#fff;
  box-shadow:0 4px 20px rgba(168,85,247,0.4); margin-bottom:10px;
  transition:opacity 0.15s, transform 0.15s;
}
.summary-leave-btn:hover { opacity:0.88; }
.summary-leave-btn:active { transform:scale(0.97); }

.summary-stay-btn {
  display:block; width:100%; padding:12px;
  border-radius:14px; border:1px solid rgba(255,255,255,0.1); cursor:pointer; font-size:0.88rem; font-weight:600;
  background:rgba(255,255,255,0.04); color:var(--text-2);
  transition:background 0.15s;
}
.summary-stay-btn:hover { background:rgba(255,255,255,0.08); }

/* ════════════════════════════════════════════════════════════════
   DESKTOP ENHANCEMENTS (≥ 768px)
   On desktop, shift layout to sidebar+main
════════════════════════════════════════════════════════════════ */
@media (min-width: 768px) {
  .room { flex-direction:row; }

  /* Topbar becomes sidebar */
  .topbar {
    position:sticky; top:0;
    width:230px; flex-shrink:0;
    height:100vh;
    flex-direction:column; justify-content:space-between;
    padding:20px 16px;
    border-bottom:none; border-right:1px solid var(--border);
    overflow-y:auto;
  }
  .topbar-brand { padding-bottom:20px; border-bottom:1px solid var(--border); }
  .topbar-right { flex-direction:column; align-items:flex-start; gap:16px; padding-top:16px; }
  .sync-chip    { font-size:0.75rem; padding:5px 12px; }
  .conn-dot     { width:8px; height:8px; }

  /* Show extra sidebar info on desktop */
  .topbar-right::before {
    content:"Playback";
    font-size:0.6rem; font-weight:700; letter-spacing:0.1em; text-transform:uppercase;
    color:var(--text-3);
  }

  .room-scroll {
    flex:1;
    max-width:none;
    margin:0;
    padding:24px 32px calc(var(--bar-h) + 24px);
  }

  .player-card {
    max-width:540px; align-self:center; width:100%;
  }

  .partner-bar, .partner-status-pill, .room-code-card, .room-code-compact {
    max-width:540px; align-self:center; width:100%;
  }

  .art-container {
    max-height:260px;
  }

  .ctrl--play { width:76px; height:76px; }
}

@media (min-width: 1024px) {
  .topbar { width:260px; }
  .room-scroll { padding:28px 40px calc(var(--bar-h) + 28px); }
  .player-card { max-width:580px; }
}

/* ── Prevent any horizontal overflow ────────────────────────── */
*, *::before, *::after { box-sizing:border-box; }
img { max-width:100%; }